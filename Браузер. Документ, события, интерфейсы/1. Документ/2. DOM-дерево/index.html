<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DOM-дерево</title>
    <link href="../../../style.css" rel="stylesheet">
</head>
<body>
    <article>
        <h2>DOM-дерево</h2>
        <p>Основной HTML-документа являются теги.</p>
        <p>В соответствии с объектной моделью документа («Document Object Model», коротко DOM), каждый HTML-тег
        является объектом. Вложенные теги являются «детьми» родительского элемента. Текст, который находится внутри
        тега, также является объектом.</p>
        <p>Все эти объекты доступны при помощи JavaScript, мы можем использовать их для изменения страницы.</p>
        <p>Например, <code>document.body</code> - объект для тега <code>&ltbody&gt</code>.</p>
        <p>Если запустить этот код, то <code>&ltbody&gt</code> станет красным на 3 секунды:</p>
        <code>
            document.body.style.background = 'red'; // Сделать фон красным<br>
            <br>
            setTimeout(() => document.body.style.background = '', 3000); // Вернуть назад
        </code>
        <p>Это был лишь небольшой пример того, что может DOM. Скоро мы изучим много способов работать с DOM,
        но сначала нужно познакомиться с его структурой.</p>
    </article>

    <article>
        <h2>Пример DOM</h2>
        <p>Начнем с такого, простого, документа:</p>
        <code>
            &lt!DOCTYPE HTML&gt<br>
            &lthtml&gt<br>
            &lthead&gt<br>
            &nbsp;&nbsp;&lttitle&gtО лосях&lttitle&gt<br>
            &lt/head&gt<br>
            &ltbody&gt<br>
            &nbsp;&nbsp;Правда о лосях.<br>
            &lt/body&gt<br>
            &lt/html&gt
        </code>
        <p>DOM - это представление HTML-документа в виде дерева тегов. Вот как оно выглядит:</p>
        <img src="images/Пример%20DOM%201.png" alt="" style="width: 30%">
        <p>Каждый узел этого дерева - это объект.</p>
        <p>Теги являются <i>узлами-элементами</i> (или просто элементами). Они образуют структуру дерева:
        <code>&lthtml&gt</code> - это корневой узел, <code>&lthead&gt</code> и <code>&ltbody&gt</code> его дочерние
        узлы и т.д.</p>
        <p>Текст внутри элементов образует <i>текстовые узлы</i>, обозначенные как <code>#text</code>.
        Текстовый узел содержит в себе только строку текста.
        У него не может быть потомков, т.е. он находится всегда на самом нижнем уровне.</p>
        <p>Например, в теге <code>&lttitle&gt</code> есть текстовый узел <code>"О лосях"</code>.</p>
        <p>Обратите внимание на специальные символы в текстовых узлах:</p>
        <ul>
            <li>
                <p>Перевод строки: <code>↵</code> (в JavaScript он обозначается как <code>\n</code>)</p>
            </li>
            <li>
                <p>Пробел <code>␣</code></p>
            </li>
        </ul>
        <p>Пробелы и переводы строки - это полноправные символы, как буквы и цифры. Они образуют текстовые узлы
        и становятся частью дерева DOM. Так, в примере выше в теге <code>&lthead&gt</code> есть несколько пробелов
        перед <code>&lttitle&gt</code>, которые образуют текстовый узел <code>#text</code> (он содержит в себе
        только перенос строки и несколько пробелов).</p>
        <p>Существует всегда два исключения из этого правила:</p>
        <ol>
            <li>
                <p>По историческим причинам пробелы и перевод строки перед тегом <code>&lthead&gt</code> игнорируются.</p>
            </li>
            <li>
                <p>Если мы записываем что-либо после закрывающегося тега <code>&lt/body&gt</code>, браузер автоматически
                перемещает эту запись в конец <code>&ltbody&gt</code>, поскольку спецификация HTML требует, чтобы
                все содержимое было внутри <code>&ltbody&gt</code>. Поэтому после закрывающегося тега <code>&lt/body&gt</code>
                не может быть никаких пробелов.</p>
            </li>
        </ol>
        <p>В остальных случаях все просто - если в документе есть пробелы (или любые другие символы), они становятся
        текстовыми узлами дерева DOM, и если мы их удалим, то в DOM их тоже не будет.</p>
        <p>Здесь пробельных текстовых узлов нет:</p>
        <code>
            &lt!DOCTYPE HTML&gt<br>
            &lthtml&gt&lthead&gt&lttitle&gtО лосях&lt/title&gt&lt/head&gt&ltbody&gtПравда о лосях.&lt/body&gt&lt/html&gt<br>
        </code>
        <img src="images/Пример%20DOM%202.png" alt="" style="width: 30%">

        <article class="note">
            <h2>Пробелы по краям строк и пробельные текстовые узлы скрыты в инструментах разработки</h2>
            <p>Когда мы работаем с деревом DOM, используя инструмента разработчика в браузере, пробелы в начале/конце
            текста и пустые текстовые узлы (переносы строк) между тегами обычно не отображаются.</p>
            <p>Таким образом инструменты разработки экономят место на экране.</p>
            <p>В дальнейших иллюстрациях DOM мы также будем для краткости пропускать пробельные текстовые узлы там,
            где они не влияют ни на то, как отображается документ.</p>
        </article>
    </article>

    <article>
        <h2>Автоисправление</h2>
        <p>Если браузер сталкивается с некорректно написанным HTML-кодом, он автоматически корректирует его при построении
        DOM.</p>
        <p>Например, в начале документа всегда должен быть тег <code>&lthtml&gt</code>. Даже если его нет в документе -
        он будет в дереве DOM, браузер его создаст. То же самое касается и тега <code>&ltbody&gt</code>.</p>
        <p>Например, если HTML-файл состоит из единственного слова <code>'Привет'</code>, браузер обернет его в теги
        <code>&lthtml&gt</code> и <code>&ltbody&gt</code>, добавит необходимый тег <code>&lthead&gt</code>, и DOM
        будет выглядеть так:</p>
        <img src="images/Автоисправление%201.png" alt="" style="width: 30%">
        <p>При генерации DOM браузер самостоятельно обрабатывает ошибки в документе, закрывает теги и так далее.</p>
        <p>Есть такой документ с незакрытыми тегами:</p>
        <code>
            &ltp&gtПривет<br>
            &ltli&gtМама<br>
            &ltli&gtи<br>
            &ltli&gtПапа
        </code>
        <p>... Но DOM будет нормальным, потому что браузер сам закрое теги и восстановит отсутствующие детали:</p>
        <img src="images/Автоисправление%202.png" alt="" style="width: 30%">

        <article class="warning">
            <h2>Таблицы всегда содержат <code>&lttbody&gt</code></h2>
            <p>Важный «особый случай» - работа с таблицами. По стандарту DOM у них должен быть <code>&lttbody&gt</code>,
            но в HTML их можно написать (официально) без него. В этом случае браузер добавляет <code>&lttbody&gt</code>
            в DOM самостоятельно.</p>
            <p>Для такого HTML:</p>
            <code>
                &lttable id="table"&gt&lttr&gt&lttd&gt1&lt/td&gt&lt/tr&gt&lt/table&gt
            </code>
            <p>DOM-структура будет такой:</p>
            <img src="images/Автоисправление%203.png" alt="" style="width: 30%">
            <p>Видите? Из пустоты появился <code>&lttbody&gt</code>, как будто документ и был таким. Важно знать об
            этом, иначе при работе с таблицами возможны сюрпризы.</p>
        </article>
    </article>

    <article>
        <h2>Другие типы узлов</h2>
        <p>Есть и некоторые другие типы узлов, кроме элементов и текстовых узлов.</p>
        <p>Например, узел-комментарий:</p>
        <code>
            &lt!DOCTYPE HTML&gt<br>
            &lthtml&gt<br>
            &ltbody&gt<br>
            &nbsp;&nbsp;Правда о лосях.<br>
            &nbsp;&nbsp;&ltol&gt<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&ltli&gtЛось -- животное хитрое&lt/li&gt<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&lt!-- комментарий --&gt<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&ltli&gt...и коварное!&lt/li&gt<br>
            &nbsp;&nbsp;&lt/ol&gt<br>
            &lt/body&gt<br>
            &lt/html&gt<br>
        </code>
        <img src="images/Другие%20типы%20узлов%201.png" alt="" style="width: 30%">
        <p>Здесь мы видим узел нового типа - <i>комментарий</i>, обозначенный как <code>#comment</code>, между двумя
        текстовыми узлами.</p>
        <p>Казалось бы - зачем комментарий в DOM? Он никак не влияет на визуальное отображение. Но есть важное правило:
        если что-то есть в HTML, то оно должно быть в DOM-дереве.</p>
        <p><b>Все, что есть в HTML, даже комментарии, является частью DOM.</b></p>
        <p>Даже директива <code>&lt!DOCTYPE...&gt</code>, которую мы ставим в начале HTML, тоже является DOM-узлом.
        Она находится в дереве DOM прямо перед <code>&lthtml&gt</code>. Мы не будет рассматривать этот узел,
        мы даже не рисуем его на наших диаграммах, но он существует.</p>
        <p>Даже объект <code>document</code>, представляющий весь документ, формально является DOM-узлом.</p>
        <p>Существует 12 типов узлов. Но на практике мы в основном работаем с 4 из них:</p>
        <ol>
            <li>
                <p><code>document</code> - «входная точка» в DOM.</p>
            </li>
            <li>
                <p>Узлы-элементы - HTML-теги, основные строительные блоки.</p>
            </li>
            <li>
                <p>Текстовые узлы - содержат текст.</p>
            </li>
            <li>
                <p>Комментарии - иногда в них можно включить информацию, которая не будет показана, но доступна в
                DOM для чтения JS.</p>
            </li>
        </ol>
    </article>

    <article>
        <h2>Взаимодействие с консолью</h2>
        <p>При работе с DOM нам часто требуется применить к нему JavaScript. Например: получить узел и запустить
        какой-нибудь код для его изменения, чтобы посмотреть результат. Вот несколько подсказок, как перемещаться между
        вкладками Elements и Console.</p>
        <p>Для начала:</p>
        <ol>
            <li>
                <p>На вкладке Elements выберите первый элемент <code>&ltli&gt</code>.</p>
            </li>
            <li>
                <p>Нажмите <kbd>Esc</kbd> - прямо под вкладкой Elements откроется Console.</p>
            </li>
        </ol>
        <p>Последний элемент, выбранный во вкладке Elements, доступен через консоль как <code>$0</code>; предыдущий,
        выбранный до него, как <code>$1</code> и т.д.</p>
        <p>Теперь мы можем запускать на них команды. Например, <code>$0.style.background = 'red'</code> сделает
        выбранный элемент красным, как здесь:</p>
        <img src="https://learn.javascript.ru/article/dom-nodes/domconsole0@2x.png" alt="" style="width: 40%">
        <p>Это мы посмотрели как получить узел из Elements в Console.</p>
        <p>Есть и обратный путь: если есть переменная <code>node</code>, ссылающаяся на DOM-узел, можно использовать
        в консоли команду <code>inspect(node)</code>, чтобы увидеть этот элемент во вкладке Elements.</p>
        <p>Или мы можем просто вывести DOM-узел в консоль и исследовать «на месте», как <code>document.body</code> ниже:</p>
        <img src="https://learn.javascript.ru/article/dom-nodes/domconsole1@2x.png" alt="" style="width: 40%">
        <p>Это может быть полезно для отладки. В следующей главе мы рассмотрим доступ и изменение DOM при помощи
        JavaScript.</p>
        <p>Инструменты разработчика в браузере отлично помогают в разработке: мы можем исследовать DOM, пробовать
        с ним что-то делать и смотреть, что идет не так.</p>
    </article>

    <article>
        <h2>Итого</h2>
        <p>HTML/XML документы представлены в браузере в виде DOM-дерева.</p>
        <ul>
            <li>
                <p>Теги становятся узлами-элементами и формируют структуру документа.</p>
            </li>
            <li>
                <p>Текст становится текстовыми узлами.</p>
            </li>
            <li>
                <p>... И т.д. Все, что записано в HTML, есть и в DOM-дереве, даже комментарии.</p>
            </li>
        </ul>
        <p>Для изменения элементов или проверки DOM-дерева мы можем использовать инструменты разработчика в браузере.</p>
        <p>Здесь мы рассмотрели основы, наиболее часто используемые и важные действия для начала разработки.
        Подробную документацию по инструментам разработки Chrome Developer Tools можно найти на странице
        <a href="https://developers.google.com/web/tools/chrome-devtools">https://developers.google.com/web/tools/chrome-devtools</a>.
        Лучший способ изучить инструменты - походить по разным вкладкам, почитать меню: большинство действий очевидны для
        пользователя. Позже, когда вы немного их изучите, прочитайте документацию и узнайте то, что осталось.</p>
        <p>У DOM-узлов есть свойства и методы, которые позволяют выбирать любой из элементов, изменять, перемещать
        их на странице и многое другое. Мы вернемся к ним в последующих разделах.</p>
    </article>
</body>
</html>