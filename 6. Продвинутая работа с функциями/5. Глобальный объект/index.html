<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Глобальный объект</title>
    <link href="../../style.css" rel="stylesheet">
</head>
<body>
    <article>
        <h2>Глобальный объект</h2>
        <p>Глобальный объект предоставляет переменные и функции, доступные в любом месте программы. По умолчанию это те,
        что встроены в язык или в среду исполнения.</p>
        <p>В браузере он называется <code>window</code>, в Node.js - <code>global</code>, в другой среде исполнения
        может называться иначе.</p>
        <p>Недавно <code>globalThis</code> был добавлен в язык как стандартизированное имя для глобального объекта,
        которое должно поддерживаться в любом окружении. Он поддерживается во всех основных браузерах.</p>
        <p>Далее мы будем использовать <code>window</code>, полагая, что наша среда - браузер. Если скрипт может
        выполняться и в другом окружении, лучше будет <code>globalThis</code>.</p>
        <p>Ко всем свойствам глобального объекта можно обращаться напрямую:</p>
        <code>
            alert('Привет!');<br>
            // Это то же самое, что и<br>
            globalThis.alert('Привет!');
        </code>
        <p>В браузере глобальные функции и переменные, объявленные с помощью <code>var</code> (не <code>let/const</code>),
        становятся свойствами глобального объекта.</p>
        <p>То же самое касается функций, объявленных с помощью Function Declaration (выражения с ключевым словом
        <code>function</code> в основном потоке кода, не Function Expression).</p>
        <p>Пожалуйста, не полагайтесь на это. Такое поведение поддерживается для совместимости. В современных проектах,
        использующих JavaScript-модули, такого не происходит.</p>
        <p>Если свойство настолько важное, что вы хотите сделать его доступным для всей программы, запишите его в
        глобальный объект напрямую:</p>
        <code>
            globalThis.currentUser = {<br>
            &nbsp;&nbsp;name: 'John'<br>
            };
        </code>
        <p>При этом обычно не рекомендуется использовать глобальные переменные. Следует применять их как можно реже.
        Дизайн кода, при котором функция получает входные параметры и выдает определенный результат, чище, надежнее
        и удобнее для тестирования, чем когда используются внешние, а тем более глобальные переменные.</p>
    </article>

    <article>
        <h2>Использование для полифилов</h2>
        <p>Глобальный объект можно использовать, чтобы проверить поддержку совместимости современных возможностей языка.</p>
        <p>Например, проверить наличие встроенного объекта <code>Promise</code> (такая поддержка отсутствует в очень
        старых браузерах):</p>
        <code>
            if (!window.Promise) {<br>
            &nbsp;&nbsp;alert('Ваш браузер очень старый!');<br>
            }
        </code>
        <p>Если нет (скажем, используется старый браузер), мы можем создать полифил: добавить функции, которые не поддерживаются
        окружением, но существуют в современном стандарте.</p>
        <code>
            if (!window.Promise) {<br>
            &nbsp;&nbsp;window.Promise = ... // Собственная реализация современной возможности языка<br>
            }
        </code>
    </article>

    <article>
        <h2>Итого</h2>
        <ul>
            <li>
                <p>Глобальный объект хранит переменные, которые должны быть доступны в любом месте программы.</p>
                <p>Это включает в себя как встроенные объекты, например, <code>Array</code>, так и характерные для окружения
                свойства, например <code>window.innerHeight</code> - высота окна браузера.</p>
            </li>
            <li>
                <p>Глобальный объект имеет универсальное имя - <code>globalThis</code>.</p>
                <p>... Но чаще на него ссылаются по-старому, используя имя, характерное для данного окружения, такое как
                <code>window</code> (браузер) и <code>global</code> (Node.js).</p>
            </li>
            <li>
                <p>Следует хранить значения в глобальном объекте, только если они действительно глобальны для нашего проекта.
                И стараться свести их количество к минимуму.</p>
            </li>
            <li>
                <p>В браузерах, если только мы не используем модули, глобальные функции и переменные, объявленные с помощью
                <code>var</code>, становятся свойствами глобального объекта.</p>
            </li>
            <li>
                <p>Для того чтобы код был проще и в будущем его легче было поддерживать, следует обращаться к свойствам
                глобального объекта напрямую, как <code>window.x</code>.</p>
            </li>
        </ul>
    </article>
</body>
</html>